!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleCardClick=s,this._handleDeleteClick=r,this._handleLikeButton=i}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeButton(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this._link,this._name)}))}updateLikes(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button-active")}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}handleDeleteButton(){this._cardElement.remove()}getView(){this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__title").textContent=this._name;const e=this._cardElement.querySelector(".card__image");return e.src=this._link,e.alt=this._name,this._isLiked&&this._cardElement.querySelector(".card__like-button").classList.add("card__like-button-active"),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._normalSubmitTextContent=this._submitButton.textContent}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t?(e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)):console.error(`Error message element not found for input: ${e.id}`)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t?(e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)):console.error(`Error message element not found for input: ${e.id}`)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid||""===e.value.trim()))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._normalSubmitTextContent}}class s{constructor(e){let{modalSelector:t}=e;this._modalElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._closeModalOnClick=this._closeModalOnClick.bind(this)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_closeModalOnClick(e){(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close-button"))&&this.close()}setEventListeners(){this._modalElement&&this._modalElement.addEventListener("mousedown",this._closeModalOnClick)}}var r=class extends s{constructor(e){let{modalSelector:t,handleFormSubmit:s}=e;super({modalSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=s}_getInputValues(){return this._inputList=this._modalForm.querySelectorAll(".modal__form-input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){this._modalForm.reset(),super.close()}};const i={formSelector:".modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s,this._checkResponse=this._checkResponse.bind(this),this._catchError=this._catchError.bind(this),this.getInitialCards=this.getInitialCards.bind(this),this.getUserInfo=this.getUserInfo.bind(this),this.updateUserInfo=this.updateUserInfo.bind(this),this.updateProfileImage=this.updateProfileImage.bind(this),this.addCard=this.addCard.bind(this),this.deleteCard=this.deleteCard.bind(this),this.likeCard=this.likeCard.bind(this)}_checkResponse(e){return e.ok?e.json():(console.log(e),Promise.reject(`Error: ${e.status}`))}_catchError(e){console.error(e)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse).catch(this._catchError)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse).then((e=>(console.log("Fetched User Info:",e),e))).catch(this._catchError)}updateUserInfo(e){return console.log("Updated user info:",e),fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse).catch(this._catchError)}updateProfileImage(e){return console.log("Updated profile image: ",e),fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.profileImage})}).then(this._checkResponse).catch(this._catchError)}addCard(e){return console.log("Added card: ",e),fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse).catch(this._catchError)}deleteCard(e){return console.log("Deleted card: ",e),fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).catch(this._catchError)}likeCard(e){return console.log("Liked card: ",e),fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse).catch(this._catchError)}unlikeCard(e){return console.log("Unliked card: ",e),fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse).catch(this._catchError)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9a90ec5a-14f2-498a-9ea3-2f40d91524b3","Content-Type":"application/json"}});const n=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-add-button"),l=document.querySelector("#profile-image-button"),d=document.querySelector("#modal-input-title"),c=document.querySelector("#modal-input-description"),h=document.forms["modal-image-form"],m=document.forms["modal-profile-form"],_=document.forms["profile-image-modal-form"],u=new class{constructor(e){let{nameSelector:t,descriptionSelector:s,avatarSelector:r}=e;this._nameElement=document.querySelector(t),this._descriptionElement=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,description:s,avatar:r}=e;t&&(this._nameElement.textContent=t),s&&(this._descriptionElement.textContent=s),r&&(this._avatarElement.src=r)}}({nameSelector:"#profile-title",descriptionSelector:"#profile-description",avatarSelector:".profile__image"}),p=new class extends s{constructor(e){let{modalSelector:t,handleFormSubmit:s}=e;super({modalSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=s}setEventListeners(){this._modalForm&&this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}setSubmitHandler(e){this._handleFormSubmit=e}}({modalSelector:"#delete-confirmation-modal",handleFormSubmit:()=>{}});p.setEventListeners();const E=new r({modalSelector:"#profile-edit-modal",handleFormSubmit:e=>{y.renderLoading(!0),o.updateUserInfo({name:e.title,about:e.description}).then((e=>{u.setUserInfo({name:e.name,description:e.about,avatar:e.avatar}),E.close()})).catch((e=>console.error(e))).finally((()=>{y.renderLoading(!1)}))}}),f=new r({modalSelector:"#add-image-modal",handleFormSubmit:e=>{C.renderLoading(!0),o.addCard({name:e.title,link:e.link}).then((e=>{k.addItem(g(e)),f.close()})).catch((e=>console.error(e))).finally((()=>{C.renderLoading(!1)}))}}),b=new r({modalSelector:"#profile-image-modal",handleFormSubmit:e=>{C.renderLoading(!0),o.updateProfileImage({profileImage:e.link}).then((e=>{u.setUserInfo({avatar:e.avatar}),b.close()})).catch((e=>console.error(e))).finally((()=>{I.renderLoading(!1)}))}}),S=new class extends s{constructor(e){super({modalSelector:e}),this._modalImage=this._modalElement.querySelector(".modal__preview")}open(e){let{name:t,link:s}=e;const r=this._modalImage.querySelector(".modal__preview-image"),i=this._modalImage.querySelector(".modal__preview-description");r.src=s,r.alt=t,i.textContent=t,super.open()}}("#image-preview-modal");function v(e,t){S.open({name:t,link:e})}function g(t){return new e(t,"#card-template",v,U,q).getView()}document.querySelectorAll(".modal").forEach((e=>{new s({modalSelector:`#${e.id}`}).setEventListeners()}));const k=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{console.log("Rendering Item:",e),this._renderer(e)}))}addItem(e){this._container.append(e)}}({items:o.getInitialCards,renderer:e=>{const t=g(e);k.addItem(t)}},".cards__list"),L=new t(i,m),C=new t(i,h),I=new t(i,_),y=new t(i,m);function U(e){p.open(),p.setSubmitHandler((()=>{e&&o.deleteCard(e.id).then((()=>{e.handleDeleteButton(),e=null,p.close()})).catch((e=>console.error(e)))}))}function q(e){e._isLiked?o.unlikeCard(e.id).then((t=>{e._isLiked=!1,e.updateLikes()})).catch((e=>console.error(e))):o.likeCard(e.id).then((()=>{e._isLiked=!0,e.updateLikes()})).catch((e=>console.error(e)))}I.enableValidation(),L.enableValidation(),C.enableValidation(),I.enableValidation(),n.addEventListener("click",(()=>{const e=u.getUserInfo();d.value=e.name,c.value=e.description,E.open(),L.resetValidation()})),a.addEventListener("click",(()=>{f.open(),C.resetValidation()})),l.addEventListener("click",(()=>{b.open(),I.resetValidation()})),E.setEventListeners(),f.setEventListeners(),b.setEventListeners(),S.setEventListeners(),Promise.all([o.getUserInfo(),o.getInitialCards()]).then((e=>{let[t,s]=e;console.log("User Data:",t),console.log("Initial Cards:",s),u.setUserInfo({name:t.name,description:t.about,avatar:t.avatar}),k.renderItems(s)})).catch((e=>console.error(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCLFNBQVMsS0FDMUNvSixFQUFjakYsT0FDZGtGLEVBQWlCaEcsaUJBQWlCLElBR3BDbUUsRUFBbUJ4SCxpQkFBaUIsU0FBUyxLQUMzQ3lKLEVBQWtCdEYsT0FDbEJ1RixFQUEwQnJHLGlCQUFpQixJQUc3Q3VGLEVBQWlCbkUsb0JBQ2pCMkUsRUFBYzNFLG9CQUNkZ0YsRUFBa0JoRixvQkFDbEJrRixFQUFrQmxGLG9CQUVsQjJCLFFBQVEwRSxJQUFJLENBQUM5QixFQUFBQSxjQUFtQkEsRUFBQUEsb0JBQzdCdkMsTUFBSzVDLElBQXVCLElBQXJCcUYsRUFBVTZCLEdBQU1sSCxFQUN0QnJCLFFBQVEyRCxJQUFJLGFBQWMrQyxHQUMxQjFHLFFBQVEyRCxJQUFJLGlCQUFrQjRFLEdBRTlCaEQsRUFBU1EsWUFBWSxDQUNuQnJKLEtBQU1nSyxFQUFTaEssS0FDZm9KLFlBQWFZLEVBQVNsQyxNQUN0QkMsT0FBUWlDLEVBQVNqQyxTQUVuQnFDLEVBQVlnQixZQUFZUyxFQUFNLElBRS9CckUsT0FBT0gsR0FBUS9ELFFBQVFDLE1BQU04RCxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL01vZGFsLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGNhcmREYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUJ1dHRvbixcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5pZCA9IGNhcmREYXRhLl9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gY2FyZERhdGEuaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b24tYWN0aXZlXCIpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG4gIGhhbmRsZURlbGV0ZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG5cbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmVcIik7XG4gICAgfVxuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9ub3JtYWxTdWJtaXRUZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlmIChlcnJvck1zZ0VsZW1lbnQpIHtcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgZXJyb3JNc2dFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgIGVycm9yTXNnRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBtZXNzYWdlIGVsZW1lbnQgbm90IGZvdW5kIGZvciBpbnB1dDogJHtpbnB1dEVsLmlkfWApO1xuICAgIH1cbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlmIChlcnJvck1zZ0VsZW1lbnQpIHtcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgZXJyb3JNc2dFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIGVycm9yTXNnRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBtZXNzYWdlIGVsZW1lbnQgbm90IGZvdW5kIGZvciBpbnB1dDogJHtpbnB1dEVsLmlkfWApO1xuICAgIH1cbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKFxuICAgICAgKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkIHx8IGlucHV0RWwudmFsdWUudHJpbSgpID09PSBcIlwiLFxuICAgICk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fbm9ybWFsU3VibWl0VGV4dENvbnRlbnQ7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKHsgbW9kYWxTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY2xvc2VNb2RhbE9uQ2xpY2sgPSB0aGlzLl9jbG9zZU1vZGFsT25DbGljay5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2Nsb3NlTW9kYWxPbkNsaWNrKGV2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSB8fFxuICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBpZiAoIXRoaXMuX21vZGFsRWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZU1vZGFsT25DbGljayk7XG4gIH1cbn1cbiIsImltcG9ydCBNb2RhbCBmcm9tIFwiLi9Nb2RhbFwiO1xuXG5jbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xuICBjb25zdHJ1Y3Rvcih7IG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHsgbW9kYWxTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybS1pbnB1dFwiKTtcblxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX21vZGFsRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTW9kYWxXaXRoRm9ybTtcbiIsImV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2Zvcm0taW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICB0aGlzLl9jaGVja1Jlc3BvbnNlID0gdGhpcy5fY2hlY2tSZXNwb25zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2NhdGNoRXJyb3IgPSB0aGlzLl9jYXRjaEVycm9yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5nZXRJbml0aWFsQ2FyZHMgPSB0aGlzLmdldEluaXRpYWxDYXJkcy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZ2V0VXNlckluZm8gPSB0aGlzLmdldFVzZXJJbmZvLmJpbmQodGhpcyk7XG4gICAgdGhpcy51cGRhdGVVc2VySW5mbyA9IHRoaXMudXBkYXRlVXNlckluZm8uYmluZCh0aGlzKTtcbiAgICB0aGlzLnVwZGF0ZVByb2ZpbGVJbWFnZSA9IHRoaXMudXBkYXRlUHJvZmlsZUltYWdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5hZGRDYXJkID0gdGhpcy5hZGRDYXJkLmJpbmQodGhpcyk7XG4gICAgdGhpcy5kZWxldGVDYXJkID0gdGhpcy5kZWxldGVDYXJkLmJpbmQodGhpcyk7XG4gICAgdGhpcy5saWtlQ2FyZCA9IHRoaXMubGlrZUNhcmQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhyZXMpO1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIF9jYXRjaEVycm9yKGVycikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgICAgLmNhdGNoKHRoaXMuX2NhdGNoRXJyb3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmV0Y2hlZCBVc2VyIEluZm86XCIsIGRhdGEpO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2godGhpcy5fY2F0Y2hFcnJvcik7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyhkYXRhKSB7XG4gICAgY29uc29sZS5sb2coXCJVcGRhdGVkIHVzZXIgaW5mbzpcIiwgZGF0YSk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5fY2F0Y2hFcnJvcik7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlSW1hZ2UoZGF0YSkge1xuICAgIGNvbnNvbGUubG9nKFwiVXBkYXRlZCBwcm9maWxlIGltYWdlOiBcIiwgZGF0YSk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBkYXRhLnByb2ZpbGVJbWFnZSxcbiAgICAgIH0pLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxuICAgICAgLmNhdGNoKHRoaXMuX2NhdGNoRXJyb3IpO1xuICB9XG5cbiAgYWRkQ2FyZChkYXRhKSB7XG4gICAgY29uc29sZS5sb2coXCJBZGRlZCBjYXJkOiBcIiwgZGF0YSk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5fY2F0Y2hFcnJvcik7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIGNvbnNvbGUubG9nKFwiRGVsZXRlZCBjYXJkOiBcIiwgY2FyZElkKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAgIC5jYXRjaCh0aGlzLl9jYXRjaEVycm9yKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIGNvbnNvbGUubG9nKFwiTGlrZWQgY2FyZDogXCIsIGNhcmRJZCk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXG4gICAgICAuY2F0Y2godGhpcy5fY2F0Y2hFcnJvcik7XG4gIH1cblxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xuICAgIGNvbnNvbGUubG9nKFwiVW5saWtlZCBjYXJkOiBcIiwgY2FyZElkKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSlcbiAgICAgIC5jYXRjaCh0aGlzLl9jYXRjaEVycm9yKTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI5YTkwZWM1YS0xNGYyLTQ5OGEtOWVhMy0yZjQwZDkxNTI0YjNcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBhcGk7XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgYXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IE1vZGFsV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBNb2RhbCBmcm9tIFwiLi4vY29tcG9uZW50cy9Nb2RhbC5qc1wiO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZE5ld0ltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlSW1hZ2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtaW1hZ2UtYnV0dG9uXCIpO1xuXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtdGl0bGVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLWlucHV0LWRlc2NyaXB0aW9uXCIsXG4pO1xuXG5jb25zdCBhZGRJbWFnZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm1vZGFsLWltYWdlLWZvcm1cIl07XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm1vZGFsLXByb2ZpbGUtZm9ybVwiXTtcbmNvbnN0IHByb2ZpbGVJbWFnZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtaW1hZ2UtbW9kYWwtZm9ybVwiXTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiI3Byb2ZpbGUtdGl0bGVcIixcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIjcHJvZmlsZS1kZXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5jb25zdCBkZWxldGVDb25maXJtYXRpb25Nb2RhbCA9IG5ldyBNb2RhbFdpdGhDb25maXJtYXRpb24oe1xuICBtb2RhbFNlbGVjdG9yOiBcIiNkZWxldGUtY29uZmlybWF0aW9uLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHt9LFxufSk7XG5kZWxldGVDb25maXJtYXRpb25Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGZvcm1EYXRhKSA9PiB7XG4gICAgcHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAudXBkYXRlVXNlckluZm8oe1xuICAgICAgICBuYW1lOiBmb3JtRGF0YS50aXRsZSxcbiAgICAgICAgYWJvdXQ6IGZvcm1EYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfSlcbiAgICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXG4gICAgICAgICAgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIsXG4gICAgICAgIH0pO1xuICAgICAgICBwcm9maWxlRWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcblxuY29uc3QgYWRkSW1hZ2VNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKHtcbiAgbW9kYWxTZWxlY3RvcjogXCIjYWRkLWltYWdlLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChmb3JtRGF0YSkgPT4ge1xuICAgIGFkZEZvcm1WYWxpZGF0b3IucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKHtcbiAgICAgICAgbmFtZTogZm9ybURhdGEudGl0bGUsXG4gICAgICAgIGxpbms6IGZvcm1EYXRhLmxpbmssXG4gICAgICB9KVxuICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkRGF0YSkpO1xuICAgICAgICBhZGRJbWFnZU1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgYWRkRm9ybVZhbGlkYXRvci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IHByb2ZpbGVJbWFnZU1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oe1xuICBtb2RhbFNlbGVjdG9yOiBcIiNwcm9maWxlLWltYWdlLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChmb3JtRGF0YSkgPT4ge1xuICAgIGFkZEZvcm1WYWxpZGF0b3IucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC51cGRhdGVQcm9maWxlSW1hZ2Uoe1xuICAgICAgICBwcm9maWxlSW1hZ2U6IGZvcm1EYXRhLmxpbmssXG4gICAgICB9KVxuICAgICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcixcbiAgICAgICAgfSk7XG4gICAgICAgIHByb2ZpbGVJbWFnZU1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcHJvZmlsZUltYWdlRm9ybVZhbGlkYXRvci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmNvbnN0IGltYWdlUHJldmlld01vZGFsID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhsaW5rLCBuYW1lKSB7XG4gIGltYWdlUHJldmlld01vZGFsLm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xufVxuXG5jb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xubW9kYWxzLmZvckVhY2goKG1vZGFsRWxlbWVudCkgPT4ge1xuICBjb25zdCBtb2RhbERlbGV0ZSA9IG5ldyBNb2RhbCh7IG1vZGFsU2VsZWN0b3I6IGAjJHttb2RhbEVsZW1lbnQuaWR9YCB9KTtcbiAgbW9kYWxEZWxldGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbn0pO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VCdXR0b24sXG4gICk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cblxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBhcGkuZ2V0SW5pdGlhbENhcmRzLFxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIixcbik7XG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkSW1hZ2VGb3JtKTtcbmNvbnN0IHByb2ZpbGVJbWFnZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVJbWFnZUZvcm0pO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xuXG5wcm9maWxlSW1hZ2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZFRvRGVsZXRlKSB7XG4gIGRlbGV0ZUNvbmZpcm1hdGlvbk1vZGFsLm9wZW4oKTtcblxuICBkZWxldGVDb25maXJtYXRpb25Nb2RhbC5zZXRTdWJtaXRIYW5kbGVyKCgpID0+IHtcbiAgICBpZiAoY2FyZFRvRGVsZXRlKSB7XG4gICAgICBhcGlcbiAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZFRvRGVsZXRlLmlkKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgY2FyZFRvRGVsZXRlLmhhbmRsZURlbGV0ZUJ1dHRvbigpO1xuICAgICAgICAgIGNhcmRUb0RlbGV0ZSA9IG51bGw7XG4gICAgICAgICAgZGVsZXRlQ29uZmlybWF0aW9uTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUJ1dHRvbihjYXJkKSB7XG4gIGlmIChjYXJkLl9pc0xpa2VkKSB7XG4gICAgYXBpXG4gICAgICAudW5saWtlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgIGNhcmQuX2lzTGlrZWQgPSBmYWxzZTtcbiAgICAgICAgY2FyZC51cGRhdGVMaWtlcygpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuX2lzTGlrZWQgPSB0cnVlO1xuICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gIH1cbn1cblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5wcm9maWxlSW1hZ2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb247XG4gIHByb2ZpbGVFZGl0TW9kYWwub3BlbigpO1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5hZGROZXdJbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRJbWFnZU1vZGFsLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5wcm9maWxlSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZUltYWdlTW9kYWwub3BlbigpO1xuICBwcm9maWxlSW1hZ2VGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbnByb2ZpbGVFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmFkZEltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnByb2ZpbGVJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5pbWFnZVByZXZpZXdNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKFwiVXNlciBEYXRhOlwiLCB1c2VyRGF0YSk7XG4gICAgY29uc29sZS5sb2coXCJJbml0aWFsIENhcmRzOlwiLCBjYXJkcyk7XG5cbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxuICAgICAgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIsXG4gICAgfSk7XG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjLFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uLCBhdmF0YXIgfSkge1xuICAgIGlmIChuYW1lKSB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgaWYgKGRlc2NyaXB0aW9uKSB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgICBpZiAoYXZhdGFyKSB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsXCI7XG5cbmNsYXNzIE1vZGFsV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBpZiAodGhpcy5fbW9kYWxGb3JtKSB7XG4gICAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRTdWJtaXRIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlcjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBNb2RhbFdpdGhDb25maXJtYXRpb247XG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kYWxXaXRoSW1hZ2UgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3XCIpO1xuICB9XG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICBjb25zdCBpbWFnZVByZXZpZXcgPSB0aGlzLl9tb2RhbEltYWdlLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiLFxuICAgICk7XG4gICAgY29uc3QgY2FwdGlvbiA9IHRoaXMuX21vZGFsSW1hZ2UucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWRlc2NyaXB0aW9uXCIsXG4gICAgKTtcblxuICAgIGltYWdlUHJldmlldy5zcmMgPSBsaW5rO1xuICAgIGltYWdlUHJldmlldy5hbHQgPSBuYW1lO1xuICAgIGNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiUmVuZGVyaW5nIEl0ZW06XCIsIGl0ZW0pO1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiY2FyZERhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VCdXR0b24iLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiaWQiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1cGRhdGVMaWtlcyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsInJlbW92ZSIsImdldFZpZXciLCJ0ZXh0Q29udGVudCIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX25vcm1hbFN1Ym1pdFRleHRDb250ZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTXNnRWxlbWVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY29uc29sZSIsImVycm9yIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsInZhbHVlIiwidHJpbSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVkIiwiZm9yRWFjaCIsInJlc2V0VmFsaWRhdGlvbiIsImRpc2FibGVCdXR0b24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJNb2RhbCIsIl9yZWYiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfY2xvc2VNb2RhbE9uQ2xpY2siLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJyZXNldCIsImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwiX2NhdGNoRXJyb3IiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsInVwZGF0ZVVzZXJJbmZvIiwidXBkYXRlUHJvZmlsZUltYWdlIiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJsaWtlQ2FyZCIsInJlcyIsIm9rIiwianNvbiIsImxvZyIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJlcnIiLCJmZXRjaCIsInRoZW4iLCJjYXRjaCIsImRhdGEiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYXZhdGFyIiwicHJvZmlsZUltYWdlIiwiY2FyZElkIiwidW5saWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImFkZE5ld0ltYWdlQnV0dG9uIiwicHJvZmlsZUltYWdlQnV0dG9uIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImFkZEltYWdlRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwicHJvZmlsZUltYWdlRm9ybSIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZGVzY3JpcHRpb24iLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiZGVsZXRlQ29uZmlybWF0aW9uTW9kYWwiLCJzZXRTdWJtaXRIYW5kbGVyIiwiaGFuZGxlciIsInByb2ZpbGVFZGl0TW9kYWwiLCJNb2RhbFdpdGhGb3JtIiwiZm9ybURhdGEiLCJwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IiLCJhcGkiLCJ0aXRsZSIsInVzZXJEYXRhIiwiZmluYWxseSIsImFkZEltYWdlTW9kYWwiLCJhZGRGb3JtVmFsaWRhdG9yIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwiY3JlYXRlQ2FyZCIsInByb2ZpbGVJbWFnZU1vZGFsIiwicHJvZmlsZUltYWdlRm9ybVZhbGlkYXRvciIsImltYWdlUHJldmlld01vZGFsIiwiX21vZGFsSW1hZ2UiLCJpbWFnZVByZXZpZXciLCJjYXB0aW9uIiwibW9kYWxFbGVtZW50IiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJjYXJkRWxlbWVudCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiY2FyZFRvRGVsZXRlIiwiY2FyZCIsImFsbCIsImNhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==